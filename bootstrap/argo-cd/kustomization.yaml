apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: vadim-local
configMapGenerator:
- name: argocd-cm
  behavior: merge
  literals:
  - |
    repository.credentials=
    - passwordSecret:
        key: git_token
        name: autopilot-secret
      url: https://github.com/
      usernameSecret:
        key: git_username
        name: autopilot-secret
- name: argocd-cm
  behavior: merge
  literals:
  - |
    configManagementPlugins=
    - name: ytt-overlay
      generate:
        command:
          - sh
          - -c
          - -e
          - |
            ytt -f .
      allowConcurrency: false
      lockRepo: false
patches:
- path: sops.yaml
  target:
    group: apps
    kind: Deployment
    name: argocd-repo-server
    version: v1
resources:
- github.com/codefresh-io/cli-v2/manifests/argo-cd?ref=v0.0.239
